<!DOCTYPE html>
<html lang="zh-tw">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drag and Upload</title>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }

        #drop-area {
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
        }

        #file-input {
            display: none;
        }

        .highlight {
            border-color: #007BFF;
        }
    </style>
</head>

<body>

    <div id="drop-area">
        <h3>Drag & Drop files here</h3>
        <p>or</p>
        <input type="file" id="file-input" multiple>
        <label for="file-input">Browse Files</label>
    </div>

    <script>
        const dropArea = document.getElementById('drop-area');

        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            dropArea.addEventListener(eventName, highlight, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, unhighlight, false);
        });

        function highlight() {
            dropArea.classList.add('highlight');
        }

        function unhighlight() {
            dropArea.classList.remove('highlight');
        }

        dropArea.addEventListener('drop', handleDrop, false);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;

            handleFiles(files);
        }

        function handleFiles(files) {
            const filesArray = Array.from(files);
            filesArray.forEach(uploadFile);
        }

        function uploadFile(file) {
    const formData = new FormData();

    // Append current date and time to the form data
    const currentDate = new Date();
    formData.append('uploadDate', currentDate.toISOString());

    // Append the file to the form data
    formData.append('files', file);

    fetch('/upload', {
        method: 'POST',
        body: formData,
    })
        .then(response => response.text())
        .then(result => {
            Toastify({
                text: result,
                duration: 3000
            }).showToast();
        })
        .catch(error => {
            Toastify({
                text: error,
                duration: 3000
            }).showToast();
        });
}

    </script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
</body>

</html>
